# go-sonarqube

![Alt](https://repobeats.axiom.co/api/embed/9761ef8e37a45d95b447066467cfdcfab4f0a0e3.svg "Repobeats analytics image")

[![Quality Gate Status](https://sonarcloud.io/api/project_badges/measure?project=shijl0925_go-sonarqube&metric=alert_status)](https://sonarcloud.io/summary/new_code?id=shijl0925_go-sonarqube)
[![Codacy Badge](https://app.codacy.com/project/badge/Grade/348d869a77a64dfc997b9a273d03d5cc)](https://app.codacy.com/gh/shijl0925/go-sonarqube/dashboard?utm_source=gh&utm_medium=referral&utm_content=&utm_campaign=Badge_grade)
[![DeepSource](https://app.deepsource.com/gh/shijl0925/go-sonarqube.svg/?label=active+issues&show_trend=true&token=PA2BnEYezTikvrDIXI4r2ryp)](https://app.deepsource.com/gh/shijl0925/go-sonarqube/)

An HTTP client to interact with the [SonarQube](https://next.sonarqube.com/sonarqube/) API from Go. It uses a service structure
similar to that of [go-github](https://github.com/google/go-github).

Most code is generated by the code in [`sonarqube-gen`](https://github.com/shijl0925/sonarqube-gen), using [`webservices.json`](https://next.sonarqube.com/sonarqube/api/webservices/list?include_internals=false)
as source of truth for the API endpoints. This is one of the first iterations of generating the API. It only supports
JSON return types and skips some endpoints that need special handling of the return values.

See https://pkg.go.dev/github.com/shijl0925/go-sonarqube/sonarqube for supported endpoints.

## Installation

```shell
go get github.com/shijl0925/go-sonarqube
```

## Usage

Use `sonarqube.NewClient` to create a new client. It needs a SonarQube baseUrl and username / password or token, and optionally accepts
an existing `*http.Client`.

After creating the client, create a new request from one of the endpoint-specific packages, i.e.
`projects.SearchRequest` from `github.com/shijl0925/go-sonarqube/sonarqube/projects`. If an endpoint supports paging,
you need to supply `ppaging.Params` as well, though in that case it might be easier to use the `All` variant of the
function. The example below, for instance, uses `client.Projects.SearchAll(req)` instead of `client.Projects.Search(req, paging)`.

The page size for automatic paging is currently set to `100`, but might be configurable later.

```go
package main
import (
	"context"
	"fmt"
	"log"
)

func main() {
    ctx := context.Background()
    baseUrl := "https://next.sonarqube.com/sonarqube"
    client := sonarqube.NewClient(baseUrl, "", "", nil)
    req := projects.SearchRequest{}

    res, err := client.Projects.SearchAll(ctx, req)
    if err != nil {
        log.Fatalf("could not search projects: %+v", err)
    }

    fmt.Printf("%+v\n", res)
}
```
